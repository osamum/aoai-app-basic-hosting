# 演習 2-5-2 : スケールアップ/アウトの設定

システムが実際に稼働を開始すると、時間の経過とともに利用者が増えていき当初に見積った数よりもリクエスト数が増えてしまったり、特定の時間帯や期間にだけアクセスが集中して負荷がサーバーの処理能力を超えてしまうことがあります。このような場合、サーバーの性能を向上させるために、サーバーのスケールアップやスケールアウトを行う必要があります。

Azure 環境ではオンプレミス上のサーバーのようなハードウェアの調達やセットアップの必要はなく、Azure ポータルや CLI ツールを使用し短い時間でスケールアップやスケールアウトの環境を構築することができます。

このタスクでは、Azure App Service でのスケールアップ、スケールアウト、自動スケーリングの設定方法について確認します。

<br>

## スケールアップ

サービスのスケールアップとは、文字通りサーバーの処理能力（スケール）を垂直方向に向上させる方法です。具体的には CPU、メモリ、ディスク領域を増やしたり、さまざまな専用のオプション機能を選択可能になります。

ただし、スケールアップにはサービスのダウンタイムが発生する可能性があるため、注意が必要です。スケールアップは、サーバーの性能を向上させるための最も簡単な方法ですが、物理的な制約により限界があります。

Azure のリソースのスケールアップは物理的なハードウェアの変更を伴わないため、Azure ポータルや CLI ツールを使用してプランを変更するだけで簡単に行うことができます。

### 🌐 App Service のスケールアップ

App Service のスケールアップは、Azure ポータルを使用したスケールアップの手順を確認しますが、メニューからプランを選択するだけなので、実際に操作は行わず UI を確認するだけで終了とします。

具体的な手順については、以下の公式ドキュメントの内容に従い作業を行ってください。

* [**Azure App Service でアプリをスケールアップする - 価格レベルのスケールアップ**](https://learn.microsoft.com/ja-jp/azure/app-service/manage-scale-up#scale-up-your-pricing-tier)

### 🛢️ Storage アカウントのスケールアップ

Azure Storage アカウントのスケールアップは、ストレージ アカウントのパフォーマンスを向上させるために、ストレージ アカウントの種類を変更することを指します。Azure Storage では、Standard と Premium の 2 つのストレージ アカウントの種類があり、Premium ストレージ アカウントは高いパフォーマンスを提供します。

既存の Standard ストレージ アカウントを Premium ストレージ アカウントに変更することはできません。新しい Premium ストレージ アカウントを作成し、データを移行する必要があります。

ただし、Azure サポートに問い合わせることで、Standard ストレージ アカウントのまま高い容量とイングレスの制限を要求することもできます。

詳しくは以下のドキュメントをご参照ください。

* Standard Storage アカウントのスケーラビリティとパフォーマンスのターゲット - [**Standard Storage アカウントのスケール ターゲット**](https://learn.microsoft.com/ja-jp/azure/storage/common/scalability-targets-standard-account?toc=%2Fazure%2Fstorage%2Fblobs%2Ftoc.json&bc=%2Fazure%2Fstorage%2Fblobs%2Fbreadcrumb%2Ftoc.json#scale-targets-for-standard-storage-accounts)

### 🔍 AI Search のスケールアップ

Azure AI Search では、パーティション数とレプリカ数を増やすことでスケールアップを行います。これにより、以下のような効果が得られます：

* パーティション数の増加：より多くのデータを格納可能に
* レプリカ数の増加：クエリのスループット向上と高可用性の確保

この設定は、演習 [AI Search の可用性ゾーンの設定](Ex02-5-1.md#-ai-search-%E3%81%AE%E5%8F%AF%E7%94%A8%E6%80%A7%E3%82%BE%E3%83%BC%E3%83%B3%E3%81%AE%E8%A8%AD%E5%AE%9A) で確認した Azure ポータルの AI Search 画面 \[設定\] - \[**スケーリング**\] メニューで行えます。また、同画面内の \[**価格レベルの変更**\] をクリックして、より大きい値を指定可能な価格レベルに変更することもできます。 

その他の詳細は以下のドキュメントをご参照ください。

* [**Azure AI Search のサービス レベルを選択する**](https://learn.microsoft.com/ja-jp/azure/search/search-sku-tier#partition-size-and-speed)

<br>

## スケールアウト

